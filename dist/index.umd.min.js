/*!
 * aux-swiper v1.0.0
 * Utilities for SwiperJS in Webflow
 * (c) 2025 AlpineUX
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).AuxSwiper={})}(this,function(e){"use strict";const t=new WeakMap,i=new WeakMap;"undefined"!=typeof window&&(window.swiperInstances=window.swiperInstances||{});const n={decodeHTMLEntities(e){if(!e)return null;return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent},parseJSON(e){if(!e||"string"!=typeof e)return null;try{return JSON.parse(e)}catch(t){const i=t instanceof Error?t.message:"Unknown error";return console.warn("Invalid JSON in Swiper config:",{error:i,input:e}),null}},getBooleanAttribute(e,t,i=!1){const n=e.getAttribute(t);return null===n?i:"true"===n||""===n},getNumberAttribute(e,t,i){const n=e.getAttribute(t);if(null===n)return i;const s=Number(n);return Number.isNaN(s)?i:s},debounce(e,t){let i;return(...n)=>{clearTimeout(i),i=setTimeout(()=>e.apply(this,n),t)}},createUniqueId(e,t){if(e.id)return e.id;return`swiper-${t}-${Date.now().toString(36)}-${Math.random().toString(36).substr(2,5)}`}};class s{constructor(e,t){this.swiperInstance=null,this.thumbsInstance=null,this.resizeObserver=null,this.element=e,this.index=t,this.uniqueId=n.createUniqueId(e,t),this.checkResponsiveState=this.checkResponsiveState.bind(this),this.debouncedResize=n.debounce(this.checkResponsiveState,250),this.init()}isSwiperAvailable(){return"undefined"!=typeof window&&("undefined"!=typeof Swiper||void 0!==window.Swiper)}getSwiperConstructor(){return"undefined"!=typeof Swiper?Swiper:"undefined"!=typeof window&&void 0!==window.Swiper?window.Swiper:null}getNavigationElements(){const e=this.element.getAttribute("data-nav-id"),t=this.element.getAttribute("data-nav-prev"),i=this.element.getAttribute("data-nav-next");let n=null,s=null;try{if(e)n=document.querySelector(`[data-trigger-prev="${e}"]`),s=document.querySelector(`[data-trigger-next="${e}"]`);else if(t||i)t&&(n=t.startsWith(".")||t.startsWith("#")||t.includes(" ")?document.querySelector(t):document.querySelector(`[data-trigger-prev="${t}"]`)),i&&(s=i.startsWith(".")||i.startsWith("#")||i.includes(" ")?document.querySelector(i):document.querySelector(`[data-trigger-next="${i}"]`));else if(n=this.element.querySelector(".swiper-button-prev, .prev-btn"),s=this.element.querySelector(".swiper-button-next, .next-btn"),!n||!s){const e=this.element.parentElement;if(e){if(!n){const t=e.querySelectorAll(".swiper-button-prev, .prev-btn");for(const e of t){const t=e.closest(".swiper");if(!t||t===this.element){n=e;break}}}if(!s){const t=e.querySelectorAll(".swiper-button-next, .next-btn");for(const e of t){const t=e.closest(".swiper");if(!t||t===this.element){s=e;break}}}}}}catch(e){console.warn("Error finding navigation elements:",e)}return"undefined"!=typeof console&&console.debug&&console.debug(`Swiper ${this.uniqueId} found navigation:`,{prevButton:(null==n?void 0:n.className)||"none",nextButton:(null==s?void 0:s.className)||"none",navId:e,prevSelector:t,nextSelector:i,swiperElement:this.element}),{prevButton:n,nextButton:s}}buildBreakpointsFromAttributes(e){const t={},i={xs:478,sm:640,md:768,lg:1024,xl:1280,"2xl":1536};return Object.keys(i).forEach(n=>{const s=e.getAttribute(`data-slides-${n}`);if(null!==s){const e=i[n];t[e]||(t[e]={});let r=s;if("auto"!==s){const e=parseFloat(s);isNaN(e)||(r=e)}t[e].slidesPerView=r}}),t}buildSwiperConfig(e,t=!1){var i,s;const{prevButton:r,nextButton:a}=this.getNavigationElements(),o={slidesPerView:e.getAttribute("data-slides-per-view")||"auto",centeredSlides:n.getBooleanAttribute(e,"data-centered"),spaceBetween:n.getNumberAttribute(e,"data-space-between",20),loop:n.getBooleanAttribute(e,"data-loop"),speed:n.getNumberAttribute(e,"data-speed",300),allowTouchMove:n.getBooleanAttribute(e,"data-allow-touch-move",!0),grabCursor:n.getBooleanAttribute(e,"data-grab-cursor"),freeMode:n.getBooleanAttribute(e,"data-free-mode"),watchSlidesProgress:n.getBooleanAttribute(e,"data-watch-slides-progress"),slidesOffsetBefore:n.getNumberAttribute(e,"data-slides-offset-before",0),slidesOffsetAfter:n.getNumberAttribute(e,"data-slides-offset-after",0),updateOnWindowResize:!0,observer:!0,observeParents:!0,observeSlideChildren:!0};if("auto"!==o.slidesPerView){const t=n.getNumberAttribute(e,"data-slides-per-view",1);o.slidesPerView=t}const d=e.getAttribute("data-autoplay");"false"!==d&&null!==d&&(o.autoplay={delay:n.getNumberAttribute(e,"data-autoplay-delay",3e3),disableOnInteraction:n.getBooleanAttribute(e,"data-autoplay-disable-interaction"),pauseOnMouseEnter:n.getBooleanAttribute(e,"data-autoplay-pause-on-hover",!0)}),(!t||e.hasAttribute("data-nav-prev")||e.hasAttribute("data-nav-next"))&&(r||a)&&(o.navigation={prevEl:r,nextEl:a,hideOnClick:n.getBooleanAttribute(e,"data-nav-hide-on-click")});const l=null===(i=e.parentElement)||void 0===i?void 0:i.querySelector(".swiper-pagination");l&&(o.pagination={el:l,clickable:!0,type:e.getAttribute("data-pagination-type")||"bullets",dynamicBullets:n.getBooleanAttribute(e,"data-pagination-dynamic"),hideOnClick:n.getBooleanAttribute(e,"data-pagination-hide-on-click")});const u=null===(s=e.parentElement)||void 0===s?void 0:s.querySelector(".swiper-scrollbar");u&&(o.scrollbar={el:u,draggable:n.getBooleanAttribute(e,"data-scrollbar-draggable",!0),hide:n.getBooleanAttribute(e,"data-scrollbar-hide")});const c=e.getAttribute("data-breakpoints");if(c){const e=n.decodeHTMLEntities(c),t=n.parseJSON(e);t&&(o.breakpoints=t)}const p=this.buildBreakpointsFromAttributes(e);return Object.keys(p).length>0&&(o.breakpoints=Object.assign(Object.assign({},o.breakpoints),p)),o.a11y={enabled:n.getBooleanAttribute(e,"data-a11y-enabled",!0),prevSlideMessage:e.getAttribute("data-a11y-prev-message")||"Previous slide",nextSlideMessage:e.getAttribute("data-a11y-next-message")||"Next slide",firstSlideMessage:e.getAttribute("data-a11y-first-message")||"This is the first slide",lastSlideMessage:e.getAttribute("data-a11y-last-message")||"This is the last slide"},n.getBooleanAttribute(e,"data-mousewheel",!1)&&(o.mousewheel={forceToAxis:n.getBooleanAttribute(e,"data-mousewheel-force-to-axis",!0),sensitivity:n.getNumberAttribute(e,"data-mousewheel-sensitivity",1),releaseOnEdges:n.getBooleanAttribute(e,"data-mousewheel-release-on-edges",!1),invert:n.getBooleanAttribute(e,"data-mousewheel-invert",!1)}),o}initializeSwiper(){if(this.element.dataset.swiperInitialized)return;if(!this.isSwiperAvailable())return void console.warn("Swiper library not found. Please include Swiper.js before this script.");const e=this.getSwiperConstructor();if(e)try{const i=this.element.getAttribute("data-thumbs"),n=i?document.querySelector(i):null;let s=this.buildSwiperConfig(this.element);if(n){const t=this.buildSwiperConfig(n,!0);this.thumbsInstance=new e(n,t),s.thumbs={swiper:this.thumbsInstance},"undefined"!=typeof window&&(window.swiperInstances[`${this.uniqueId}-thumbs`]=this.thumbsInstance)}this.swiperInstance=new e(this.element,s),t.set(this.element,this.swiperInstance),"undefined"!=typeof window&&(window.swiperInstances[this.uniqueId]=this.swiperInstance),this.element.dataset.swiperInitialized="true",this.dispatchEvent("swiperInitialized",{swiper:this.swiperInstance,config:s,thumbs:this.thumbsInstance})}catch(e){console.error("Error initializing Swiper:",e),this.dispatchEvent("swiperError",{error:e})}else console.error("Unable to access Swiper constructor.")}destroySwiper(){try{this.swiperInstance&&(this.swiperInstance.destroy(!0,!0),t.delete(this.element),"undefined"!=typeof window&&delete window.swiperInstances[this.uniqueId],this.swiperInstance=null),this.thumbsInstance&&(this.thumbsInstance.destroy(!0,!0),"undefined"!=typeof window&&delete window.swiperInstances[`${this.uniqueId}-thumbs`],this.thumbsInstance=null),delete this.element.dataset.swiperInitialized,this.dispatchEvent("swiperDestroyed")}catch(e){console.error("Error destroying Swiper:",e)}}checkResponsiveState(){const e=window.innerWidth,t=n.getNumberAttribute(this.element,"data-disable-swiper-min-width",NaN),i=n.getNumberAttribute(this.element,"data-disable-swiper-max-width",NaN);!isNaN(t)&&!isNaN(i)&&e>=t&&e<=i||!isNaN(t)&&isNaN(i)&&e>=t||!isNaN(i)&&isNaN(t)&&e<=i?this.element.dataset.swiperInitialized&&this.destroySwiper():this.element.dataset.swiperInitialized||this.initializeSwiper()}dispatchEvent(e,t={}){try{this.element.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,cancelable:!0}))}catch(t){console.warn(`Error dispatching ${e} event:`,t)}}init(){this.element.dataset.swiperInitialized||(this.checkResponsiveState(),"undefined"!=typeof window&&"ResizeObserver"in window&&(this.resizeObserver=new ResizeObserver(this.debouncedResize),this.resizeObserver.observe(document.documentElement),i.set(this.element,this.resizeObserver)),this.element.swiperAPI={init:()=>this.initializeSwiper(),destroy:()=>this.destroySwiper(),getInstance:()=>this.swiperInstance,getThumbsInstance:()=>this.thumbsInstance,refresh:()=>this.checkResponsiveState(),update:()=>{var e;return null===(e=this.swiperInstance)||void 0===e?void 0:e.update()},updateSize:()=>{var e;return null===(e=this.swiperInstance)||void 0===e?void 0:e.updateSize()},updateSlides:()=>{var e;return null===(e=this.swiperInstance)||void 0===e?void 0:e.updateSlides()}})}cleanup(){this.destroySwiper(),"undefined"!=typeof window&&(this.resizeObserver?(this.resizeObserver.disconnect(),i.delete(this.element)):window.removeEventListener("resize",this.debouncedResize)),delete this.element.swiperAPI}}var r=Object.freeze({__proto__:null,SwiperManager:s,initializeSwipers:function e(){if("undefined"!=typeof document&&"loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",e);if("undefined"==typeof document)return;const t=document.querySelectorAll(".swiper"),i=[];t.forEach((e,t)=>{try{const n=new s(e,t);i.push(n)}catch(e){console.error("Error initializing Swiper manager:",e)}}),"undefined"!=typeof window&&(window.cleanupSwipers=()=>{i.forEach(e=>e.cleanup()),i.length=0},window.addEventListener("beforeunload",window.cleanupSwipers))},utils:n});function a(){Promise.resolve().then(function(){return r}).then(({initializeSwipers:e})=>{e()})}"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):a()),"undefined"!=typeof window&&(window.AuxSwiper={SwiperManager:()=>Promise.resolve().then(function(){return r}).then(e=>e.SwiperManager),utils:()=>Promise.resolve().then(function(){return r}).then(e=>e.utils),init:a}),e.SwiperManager=s,e.utils=n});
